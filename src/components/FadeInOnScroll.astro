---
interface Props {
  delay?: number;
}

const { delay = 0 } = Astro.props;
---

<div class="fade-in-section" style={`animation-delay: ${delay}ms`}>
  <slot />
</div>

<script>
  document.addEventListener('astro:page-load', () => {
    const fadeElems = document.querySelectorAll('.fade-in-section');

    const appearOptions = {
      threshold: 0.15,
      rootMargin: "0px 0px -100px 0px"
    };

    const appearOnScroll = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
        } else {
          entry.target.classList.remove('is-visible');
        }
      });
    }, appearOptions);

    fadeElems.forEach(elem => {
      appearOnScroll.observe(elem);
    });
  });
</script>

<style>
  .fade-in-section {
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.8s ease-out, transform 0.8s ease-out;
  }

  .fade-in-section.is-visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>
